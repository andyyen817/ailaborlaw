<template>
  <div class="mobile-consultation-container">
    <!-- é é¢é ­éƒ¨ -->
    <div class="sticky top-0 z-10 bg-white shadow-sm">
      <div class="flex items-center px-4 py-3">
        <router-link to="/mobile" class="flex items-center text-blue-600">
          <svg width="20" height="20" viewBox="0 0 576 512" fill="currentColor" class="mr-2">
            <path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"/>
          </svg>
          <span>å›åˆ°é¦–é </span>
        </router-link>
        <h1 class="text-lg font-medium text-center flex-1 mr-8">å°ˆå®¶è«®è©¢æœå‹™</h1>
      </div>
    </div>

    <!-- é é¢å…§å®¹ -->
    <div class="px-4 py-4 pb-24">
      <!-- å³æ™‚è«®è©¢ç®¡é“ -->
      <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
        <h2 class="text-lg font-semibold text-gray-800 mb-3">å³æ™‚è«®è©¢ç®¡é“</h2>
        <p class="text-gray-600 text-sm mb-4">
          é‡å°è¼ƒç‚ºè¤‡é›œæˆ–ç‰¹æ®Šçš„å‹å‹•æ³•è¦å•é¡Œï¼Œå»ºè­°æ‚¨è¯ç¹«æˆ‘å€‘çš„å°ˆæ¥­é¡§å•ç²å–æ›´è©³ç´°çš„æŒ‡å°ã€‚
        </p>
        
        <div class="space-y-4">
          <!-- LINEè«®è©¢ -->
          <div class="contact-card border border-gray-200 rounded-lg p-4 flex items-center">
            <div class="icon-wrapper bg-green-100 rounded-full p-3 mr-3 flex-shrink-0">
              <i class="fab fa-line text-xl text-green-600"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-medium text-gray-800">LINE è«®è©¢</h3>
              <p class="text-gray-600 text-sm">ID: wed11223</p>
              <p class="text-xs text-gray-500 mt-1">æ¨è–¦ç”¨æ–¼å³æ™‚å°è©±å’Œå¿«é€Ÿå•ç­”</p>
            </div>
            <div class="ml-2">
              <button class="p-2 text-green-600 bg-green-50 rounded-full">
                <i class="fas fa-external-link-alt"></i>
              </button>
            </div>
          </div>
          
          <!-- é›»å­éƒµä»¶è«®è©¢ -->
          <div class="contact-card border border-gray-200 rounded-lg p-4 flex items-center">
            <div class="icon-wrapper bg-blue-100 rounded-full p-3 mr-3 flex-shrink-0">
              <i class="fas fa-envelope text-xl text-blue-600"></i>
            </div>
            <div class="flex-1">
              <h3 class="font-medium text-gray-800">é›»å­éƒµä»¶è«®è©¢</h3>
              <p class="text-gray-600 text-sm">wed801001@gmail.com</p>
              <p class="text-xs text-gray-500 mt-1">é©åˆè©³ç´°å•é¡Œå’Œéœ€è¦æ–‡ä»¶é™„ä»¶çš„æƒ…æ³</p>
            </div>
            <div class="ml-2">
              <button class="p-2 text-blue-600 bg-blue-50 rounded-full">
                <i class="fas fa-external-link-alt"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- å°ˆäººè«®è©¢é ç´„è¡¨å–® -->
      <div class="bg-white rounded-lg shadow-sm p-4">
        <h2 class="text-lg font-semibold text-gray-800 mb-3">å°ˆäººè«®è©¢é ç´„</h2>
        <p class="text-gray-600 text-sm mb-4">
          å¡«å¯«ä»¥ä¸‹è¡¨å–®ï¼Œæˆ‘å€‘çš„å°ˆæ¥­é¡§å•å°‡åœ¨24å°æ™‚å…§èˆ‡æ‚¨è¯ç¹«ï¼Œç‚ºæ‚¨æä¾›é‡å°æ€§çš„å‹å‹•æ³•è¦è«®è©¢æœå‹™ã€‚
        </p>
        
        <form @submit.prevent="submitForm">
          <!-- åŸºæœ¬ä¿¡æ¯ -->
          <div class="space-y-4 mb-6">
            <!-- å§“å -->
            <div class="form-group">
              <label for="name" class="block text-sm font-medium text-gray-700 mb-1">
                å§“å <span class="text-red-500">*</span>
              </label>
              <input
                v-model="form.name"
                type="text"
                id="name"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base"
                placeholder="è«‹è¼¸å…¥æ‚¨çš„çœŸå¯¦å§“åï¼Œä¾‹å¦‚ï¼šé™³å¤§æ˜"
                required
                maxlength="50"
                @blur="validateField('name')"
              />
              <small class="text-gray-500 text-xs mt-1 block">è«‹è¼¸å…¥ä¸­æ–‡æˆ–è‹±æ–‡å§“åï¼Œ2-50å€‹å­—ç¬¦</small>
              <span v-if="errors.name" class="text-red-600 text-xs mt-1 block">{{ errors.name }}</span>
            </div>
            
            <!-- åœ°å€é¸æ“‡ - ç§»å‹•ç«¯å„ªåŒ– -->
            <div class="form-group">
              <label for="region" class="block text-sm font-medium text-gray-700 mb-1">
                æ‰€åœ¨åœ°å€ <span class="text-gray-400">(å¯é¸)</span>
              </label>
              <select
                v-model="form.region"
                id="region"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base bg-white"
                @change="validateField('region')"
              >
                <option value="">è«‹é¸æ“‡æ‚¨æ‰€åœ¨çš„ç¸£å¸‚</option>
                <!-- ç›´è½„å¸‚ -->
                <option value="å°åŒ—å¸‚">å°åŒ—å¸‚</option>
                <option value="æ–°åŒ—å¸‚">æ–°åŒ—å¸‚</option>
                <option value="æ¡ƒåœ’å¸‚">æ¡ƒåœ’å¸‚</option>
                <option value="å°ä¸­å¸‚">å°ä¸­å¸‚</option>
                <option value="å°å—å¸‚">å°å—å¸‚</option>
                <option value="é«˜é›„å¸‚">é«˜é›„å¸‚</option>
                <!-- ç¸£ -->
                <option value="åŸºéš†å¸‚">åŸºéš†å¸‚</option>
                <option value="æ–°ç«¹å¸‚">æ–°ç«¹å¸‚</option>
                <option value="æ–°ç«¹ç¸£">æ–°ç«¹ç¸£</option>
                <option value="è‹—æ —ç¸£">è‹—æ —ç¸£</option>
                <option value="å½°åŒ–ç¸£">å½°åŒ–ç¸£</option>
                <option value="å—æŠ•ç¸£">å—æŠ•ç¸£</option>
                <option value="é›²æ—ç¸£">é›²æ—ç¸£</option>
                <option value="å˜‰ç¾©å¸‚">å˜‰ç¾©å¸‚</option>
                <option value="å˜‰ç¾©ç¸£">å˜‰ç¾©ç¸£</option>
                <option value="å±æ±ç¸£">å±æ±ç¸£</option>
                <option value="å®œè˜­ç¸£">å®œè˜­ç¸£</option>
                <option value="èŠ±è“®ç¸£">èŠ±è“®ç¸£</option>
                <option value="å°æ±ç¸£">å°æ±ç¸£</option>
                <option value="æ¾æ¹–ç¸£">æ¾æ¹–ç¸£</option>
                <option value="é‡‘é–€ç¸£">é‡‘é–€ç¸£</option>
                <option value="é€£æ±Ÿç¸£">é€£æ±Ÿç¸£</option>
              </select>
              <small class="text-gray-500 text-xs mt-1 block">é¸æ“‡æ‚¨æ‰€åœ¨çš„ç¸£å¸‚ï¼Œæœ‰åŠ©æ–¼æˆ‘å€‘å®‰æ’ç•¶åœ°çš„å°ˆæ¥­é¡§å•</small>
              <span v-if="errors.region" class="text-red-600 text-xs mt-1 block">{{ errors.region }}</span>
            </div>
            
            <!-- è¯çµ¡é›»è©± -->
            <div class="form-group">
              <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">
                è¯çµ¡é›»è©± <span class="text-red-500">*</span>
              </label>
              <input
                v-model="form.phone"
                type="tel"
                id="phone"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base"
                placeholder="è«‹è¼¸å…¥å°ç£æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œä¾‹å¦‚ï¼š0912345678"
                required
                pattern="^(\+886-?)?0?9\d{8}$"
                maxlength="15"
                @blur="validateField('phone')"
                @input="formatPhoneNumber"
              />
              <small class="text-gray-500 text-xs mt-1 block">è«‹è¼¸å…¥å°ç£æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ï¼š09xxxxxxxx æˆ–å¸‚è©±æ ¼å¼</small>
              <span v-if="errors.phone" class="text-red-600 text-xs mt-1 block">{{ errors.phone }}</span>
            </div>
            
            <!-- Line ID -->
            <div class="form-group">
              <label for="lineId" class="block text-sm font-medium text-gray-700 mb-1">
                Line ID <span class="text-gray-400">(å¯é¸)</span>
              </label>
              <input
                v-model="form.lineId"
                type="text"
                id="lineId"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base"
                placeholder="è«‹è¼¸å…¥æ‚¨çš„Line IDï¼Œä¾‹å¦‚ï¼šmylineid123"
                maxlength="50"
                @blur="validateField('lineId')"
              />
              <small class="text-gray-500 text-xs mt-1 block">å¦‚æœæ‚¨æœ‰Lineå¸³è™Ÿï¼Œå¯æä¾›Line IDæ–¹ä¾¿è¯ç¹«</small>
              <span v-if="errors.lineId" class="text-red-600 text-xs mt-1 block">{{ errors.lineId }}</span>
            </div>
            
            <!-- é›»å­éƒµä»¶ -->
            <div class="form-group">
              <label for="email" class="block text-sm font-medium text-gray-700 mb-1">
                é›»å­éƒµä»¶ <span class="text-gray-400">(å¯é¸)</span>
              </label>
              <input
                v-model="form.email"
                type="email"
                id="email"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base"
                placeholder="è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµç®±ï¼Œä¾‹å¦‚ï¼šexample@gmail.com"
                maxlength="100"
                @blur="validateField('email')"
              />
              <small class="text-gray-500 text-xs mt-1 block">è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµç®±åœ°å€ï¼Œæ ¼å¼ï¼šuser@domain.com</small>
              <span v-if="errors.email" class="text-red-600 text-xs mt-1 block">{{ errors.email }}</span>
            </div>
          </div>
          
          <!-- æœå‹™å’Œæ™‚é–“ -->
          <div class="space-y-4 mb-6">
            <!-- å¸Œæœ›ç²å¾—çš„æœå‹™ -->
            <div class="form-group">
              <label for="service" class="block text-sm font-medium text-gray-700 mb-1">
                å¸Œæœ›ç²å¾—çš„æœå‹™ <span class="text-red-500">*</span>
              </label>
              <select
                v-model="form.service"
                id="service"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base bg-white"
                required
                @change="validateField('service')"
              >
                <option value="" disabled>è«‹é¸æ“‡æ‚¨éœ€è¦çš„æœå‹™é¡å‹</option>
                <option value="labor_contract">å‹å‹•å¥‘ç´„å¯©æ ¸ - åˆç´„æ¢æ¬¾ã€ç°½ç´„å•é¡Œ</option>
                <option value="compensation">è–ªè³‡èˆ‡åŠ ç­è²»å•é¡Œ - å·¥è³‡è¨ˆç®—ã€åŠ ç­è²»ç³¾ç´›</option>
                <option value="termination">çµ‚æ­¢åƒ±å‚­é—œä¿‚ - è§£åƒ±ã€é›¢è·ã€è³‡é£ç›¸é—œ</option>
                <option value="workplace_safety">è·å ´å®‰å…¨å•é¡Œ - å·¥ä½œç’°å¢ƒã€è·æ¥­å‚·å®³</option>
                <option value="discrimination">å°±æ¥­æ­§è¦–å•é¡Œ - æ€§åˆ¥ã€å¹´é½¡ã€ç¨®æ—æ­§è¦–</option>
                <option value="other">å…¶ä»–å•é¡Œ - ä¸Šè¿°æœªæ¶µè“‹çš„å‹å‹•æ³•è¦å•é¡Œ</option>
              </select>
              <small class="text-gray-500 text-xs mt-1 block">è«‹é¸æ“‡æœ€ç¬¦åˆæ‚¨å•é¡Œçš„æœå‹™é¡å‹ï¼Œä»¥ä¾¿å®‰æ’å°ˆæ¥­é¡§å•</small>
              <span v-if="errors.service" class="text-red-600 text-xs mt-1 block">{{ errors.service }}</span>
            </div>
            
            <!-- å¸Œæœ›è«®è©¢æ™‚é–“ -->
            <div class="form-group">
              <label for="consultationTime" class="block text-sm font-medium text-gray-700 mb-1">
                å¸Œæœ›è«®è©¢æ™‚é–“ <span class="text-gray-400">(å¯é¸)</span>
              </label>
              <div class="grid grid-cols-1 gap-3">
                <select
                  v-model="form.timeOfDay"
                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base bg-white"
                  @change="validateField('consultationTime')"
                >
                  <option value="morning">ä¸Šåˆ (09:00-12:00)</option>
                  <option value="afternoon">ä¸‹åˆ (13:00-18:00)</option>
                  <option value="evening">æ™šä¸Š (19:00-21:00)</option>
                </select>
                <div class="flex items-center">
                <div class="flex-1">
                  <label class="text-xs text-gray-500">åå¥½é–‹å§‹æ™‚é–“</label>
                  <select
                    v-model="form.startTime"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base bg-white"
                    @change="validateField('consultationTime')"
                  >
                    <option value="">é¸æ“‡æ™‚é–“</option>
                    <option value="09:00">09:00</option>
                    <option value="09:30">09:30</option>
                    <option value="10:00">10:00</option>
                    <option value="10:30">10:30</option>
                    <option value="11:00">11:00</option>
                    <option value="11:30">11:30</option>
                    <option value="13:00">13:00</option>
                    <option value="13:30">13:30</option>
                    <option value="14:00">14:00</option>
                    <option value="14:30">14:30</option>
                    <option value="15:00">15:00</option>
                    <option value="15:30">15:30</option>
                    <option value="16:00">16:00</option>
                    <option value="16:30">16:30</option>
                    <option value="17:00">17:00</option>
                    <option value="17:30">17:30</option>
                  </select>
                </div>
                <span class="mx-2 text-gray-400">-</span>
                <div class="flex-1">
                  <label class="text-xs text-gray-500">åå¥½çµæŸæ™‚é–“</label>
                  <select
                    v-model="form.endTime"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base bg-white"
                    @change="validateField('consultationTime')"
                  >
                    <option value="">é¸æ“‡æ™‚é–“</option>
                    <option value="09:30">09:30</option>
                    <option value="10:00">10:00</option>
                    <option value="10:30">10:30</option>
                    <option value="11:00">11:00</option>
                    <option value="11:30">11:30</option>
                    <option value="12:00">12:00</option>
                    <option value="13:00">13:00</option>
                    <option value="13:30">13:30</option>
                    <option value="14:00">14:00</option>
                    <option value="14:30">14:30</option>
                    <option value="15:00">15:00</option>
                    <option value="15:30">15:30</option>
                    <option value="16:00">16:00</option>
                    <option value="16:30">16:30</option>
                    <option value="17:00">17:00</option>
                    <option value="17:30">17:30</option>
                    <option value="18:00">18:00</option>
                  </select>
                                  </div>
                </div>
              </div>
              <small class="text-gray-500 text-xs mt-1 block">è«‹é¸æ“‡æ‚¨æ–¹ä¾¿æ¥å—è«®è©¢çš„æ™‚é–“æ®µï¼Œæˆ‘å€‘æœƒç›¡é‡é…åˆæ‚¨çš„æ™‚é–“å®‰æ’</small>
              <span v-if="errors.consultationTime" class="text-red-600 text-xs mt-1 block">{{ errors.consultationTime }}</span>
            </div>
          </div>
          
          <!-- å•é¡Œè©³æƒ… -->
          <div class="form-group mb-6">
            <label for="details" class="block text-sm font-medium text-gray-700 mb-1">
              å•é¡Œè©³æƒ… <span class="text-red-500">*</span>
            </label>
            <textarea
              v-model="form.details"
              id="details"
              rows="4"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-base"
              placeholder="è«‹è©³ç´°æè¿°æ‚¨é‡åˆ°çš„å•é¡Œæˆ–éœ€è¦è«®è©¢çš„å…§å®¹ï¼Œä¾‹å¦‚ï¼š&#10;â€¢ å…·é«”ç™¼ç”Ÿäº†ä»€éº¼äº‹æƒ…ï¼Ÿ&#10;â€¢ æ¶‰åŠå“ªäº›æ¢æ¬¾æˆ–è¦å®šï¼Ÿ&#10;â€¢ æ‚¨å¸Œæœ›äº†è§£å“ªäº›æ³•å¾‹æ¬Šç›Šï¼Ÿ&#10;&#10;è©³ç´°çš„æè¿°æœ‰åŠ©æ–¼æˆ‘å€‘ç‚ºæ‚¨æä¾›æ›´ç²¾æº–çš„æ³•å¾‹å»ºè­°ã€‚"
              required
              minlength="10"
              maxlength="1000"
              @blur="validateField('details')"
              @input="updateDetailsCount"
            ></textarea>
            <div class="flex justify-between items-center mt-1">
              <small class="text-gray-500 text-xs">è«‹è©³ç´°æè¿°æ‚¨çš„å•é¡Œï¼Œè‡³å°‘10å€‹å­—ç¬¦ï¼Œæœ€å¤š1000å€‹å­—ç¬¦</small>
              <small class="text-gray-500 text-xs">{{ form.details.length }}/1000</small>
            </div>
            <span v-if="errors.details" class="text-red-600 text-xs mt-1 block">{{ errors.details }}</span>
          </div>
          
          <!-- åå¥½è¯çµ¡æ–¹å¼ -->
          <div class="form-group mb-8">
            <label for="preferred_contact" class="block text-sm font-medium text-gray-700 mb-2">
              åå¥½è¯çµ¡æ–¹å¼ <span class="text-red-500">*</span>
            </label>
            <div class="grid grid-cols-3 gap-2">
              <label class="bg-white border border-gray-300 rounded-lg p-3 flex flex-col items-center justify-center cursor-pointer transition-colors" :class="{ 'border-primary bg-primary-50': form.preferredContact.phone }">
                <input type="checkbox" v-model="form.preferredContact.phone" class="sr-only" @change="validateField('preferredContact')" />
                <svg class="text-lg mb-1" width="20" height="20" viewBox="0 0 512 512" fill="currentColor" :class="form.preferredContact.phone ? 'text-primary' : 'text-gray-500'">
                  <path d="M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"/>
                </svg>
                <span class="text-xs" :class="form.preferredContact.phone ? 'text-primary' : 'text-gray-500'">é›»è©±</span>
              </label>
              <label class="bg-white border border-gray-300 rounded-lg p-3 flex flex-col items-center justify-center cursor-pointer transition-colors" :class="{ 'border-primary bg-primary-50': form.preferredContact.line }">
                <input type="checkbox" v-model="form.preferredContact.line" class="sr-only" @change="validateField('preferredContact')" />
                <i class="fab fa-line text-lg mb-1" :class="form.preferredContact.line ? 'text-primary' : 'text-gray-500'"></i>
                <span class="text-xs" :class="form.preferredContact.line ? 'text-primary' : 'text-gray-500'">LINE</span>
              </label>
              <label class="bg-white border border-gray-300 rounded-lg p-3 flex flex-col items-center justify-center cursor-pointer transition-colors" :class="{ 'border-primary bg-primary-50': form.preferredContact.email }">
                <input type="checkbox" v-model="form.preferredContact.email" class="sr-only" @change="validateField('preferredContact')" />
                <i class="fas fa-envelope text-lg mb-1" :class="form.preferredContact.email ? 'text-primary' : 'text-gray-500'"></i>
                <span class="text-xs" :class="form.preferredContact.email ? 'text-primary' : 'text-gray-500'">é›»å­éƒµä»¶</span>
              </label>
            </div>
            <small class="text-gray-500 text-xs mt-2 block">è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®è¯çµ¡æ–¹å¼ï¼Œæˆ‘å€‘æœƒé€éæ‚¨é¸æ“‡çš„æ–¹å¼èˆ‡æ‚¨è¯ç¹«</small>
            <span v-if="errors.preferredContact" class="text-red-600 text-xs mt-1 block">{{ errors.preferredContact }}</span>
          </div>
        </form>
      </div>
    </div>
    
    <!-- å›ºå®šåœ¨åº•éƒ¨çš„æäº¤æŒ‰éˆ• -->
    <div class="fixed bottom-0 left-0 right-0 bg-white shadow-lg p-3 border-t border-gray-200">
      <button
        @click="submitForm"
        class="w-full bg-primary hover:bg-primary-dark text-white font-medium py-3 px-4 rounded-lg focus:outline-none text-base transition-colors"
        :disabled="isSubmitting"
      >
        <span v-if="isSubmitting" class="flex items-center justify-center">
          <i class="fas fa-spinner fa-spin mr-2"></i>æäº¤ç”³è«‹ä¸­...
        </span>
        <span v-else>æäº¤è«®è©¢ç”³è«‹</span>
      </button>
    </div>
    
    <!-- æˆåŠŸæäº¤æ¶ˆæ¯ -->
    <div v-if="isSubmitSuccess" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50">
      <div class="bg-white rounded-lg p-5 m-4 w-full max-w-sm">
        <div class="text-center mb-4">
          <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-green-100 mb-2">
            <svg width="28" height="28" viewBox="0 0 512 512" fill="#10b981">
              <path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"/>
            </svg>
          </div>
          <h3 class="text-xl font-semibold text-gray-800">ç”³è«‹æäº¤æˆåŠŸï¼</h3>
          <p class="text-gray-600 text-sm mt-2 mb-5">
            æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„è«®è©¢ç”³è«‹ï¼Œå°ˆæ¥­é¡§å•å°‡åœ¨24å°æ™‚å…§èˆ‡æ‚¨è¯ç¹«ã€‚
          </p>
        </div>
        
        <div class="space-y-3">
          <button 
            @click="isSubmitSuccess = false" 
            class="w-full bg-primary hover:bg-primary-dark text-white font-medium py-3 px-4 rounded-lg focus:outline-none transition-colors"
          >
            ç¢ºå®š
          </button>
          <router-link 
            to="/" 
            class="block w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg focus:outline-none transition-colors text-center"
          >
            è¿”å›å‹æ³•é€šAI
          </router-link>
        </div>
        
        <button 
          @click="isSubmitSuccess = false" 
          class="absolute top-2 right-2 text-gray-400 hover:text-gray-600 p-2"
          aria-label="é—œé–‰"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue';
import { useRouter, useRoute } from 'vue-router';
import authService from '@/services/auth';
import dataManager, { DATA_TYPES } from '../services/dataManager.js';
import expertConsultationService from '@/services/expertConsultationService.js';

const router = useRouter();
const route = useRoute();

// èªè­‰æª¢æŸ¥å‡½æ•¸
const checkAuthenticationAndRedirect = () => {
  console.log('MobileConsultation: æª¢æŸ¥ç”¨æˆ¶èªè­‰ç‹€æ…‹');
  
  if (!authService.isAuthenticated()) {
    console.warn('MobileConsultation: ç”¨æˆ¶æœªç™»éŒ„ï¼Œé‡å®šå‘åˆ°ç™»éŒ„é ');
    const currentPath = route.fullPath;
    router.push(`/mobile/login?redirect=${encodeURIComponent(currentPath)}`);
    return false;
  }
  
  console.log('MobileConsultation: ç”¨æˆ¶å·²èªè­‰ï¼Œå…è¨±è¨ªå•');
  return true;
};

// çµ„ä»¶è¼‰å…¥æ™‚æª¢æŸ¥èªè­‰
onMounted(() => {
  console.log('MobileConsultation: çµ„ä»¶è¼‰å…¥ï¼Œæª¢æŸ¥èªè­‰ç‹€æ…‹');
  if (!checkAuthenticationAndRedirect()) {
    return; // å¦‚æœèªè­‰å¤±æ•—ï¼Œç›´æ¥è¿”å›ï¼Œé¿å…ç¹¼çºŒåŸ·è¡Œå…¶ä»–é‚è¼¯
  }
  
  // é å¡«ç”¨æˆ¶ä¿¡æ¯
  try {
    const user = authService.getCurrentUser();
    if (user) {
      console.log('MobileConsultation: é å¡«ç”¨æˆ¶ä¿¡æ¯');
      form.name = user.name || '';
      form.email = user.email || '';
      form.phone = user.phoneNumber || user.phone || '';
    }
  } catch (error) {
    console.error('MobileConsultation: ç²å–ç”¨æˆ¶ä¿¡æ¯å¤±æ•—:', error);
  }
});

// è¡¨å–®æ•¸æ“š
const form = reactive({
  name: '',
  region: '',  // æ–°å¢åœ°å€å­—æ®µ
  phone: '',
  email: '',
  lineId: '',
  service: '',
  details: '',
  preferredContact: {
    phone: false,
    line: false,
    email: false
  },
  timeOfDay: 'morning',
  startTime: '',
  endTime: ''
});

// éŒ¯èª¤ä¿¡æ¯
const errors = reactive({
  name: '',
  region: '',  // æ–°å¢åœ°å€éŒ¯èª¤å­—æ®µ
  phone: '',
  email: '',
  lineId: '',
  service: '',
  details: '',
  preferredContact: '',
  consultationTime: ''
});

// æäº¤ç‹€æ…‹
const isSubmitting = ref(false);
const isSubmitSuccess = ref(false);

// é©—è­‰è¡¨å–®
function validateForm() {
  let isValid = true;
  
  // é‡ç½®éŒ¯èª¤ä¿¡æ¯
  Object.keys(errors).forEach(key => {
    errors[key] = '';
  });
  
  // é©—è­‰å§“å
  if (!form.name.trim()) {
    errors.name = 'è«‹è¼¸å…¥æ‚¨çš„å§“å';
    isValid = false;
  } else if (form.name.trim().length < 2) {
    errors.name = 'å§“åè‡³å°‘éœ€è¦2å€‹å­—ç¬¦';
    isValid = false;
  } else if (form.name.trim().length > 50) {
    errors.name = 'å§“åä¸èƒ½è¶…é50å€‹å­—ç¬¦';
    isValid = false;
  }
  
  // é©—è­‰é›»è©±ï¼ˆå°ç£æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ï¼‰
  if (!form.phone.trim()) {
    errors.phone = 'è«‹è¼¸å…¥æ‚¨çš„è¯çµ¡é›»è©±';
    isValid = false;
  } else {
    // ğŸ”§ ä¿®å¾©ï¼šåœ¨é©—è­‰å‰å…ˆç§»é™¤æ‰€æœ‰éæ•¸å­—å­—ç¬¦ï¼Œä»¥å…¼å®¹æ ¼å¼åŒ–å¾Œçš„é›»è©±è™Ÿç¢¼
    const cleanPhone = form.phone.replace(/\D/g, '');
    
    // å°ç£æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼é©—è­‰ï¼š09xxxxxxxx
    const phoneRegex = /^0?9\d{8}$/;  // ç°¡åŒ–ç‚ºç´”æ•¸å­—é©—è­‰
    // ä¹Ÿæ”¯æ´å¸‚è©±æ ¼å¼ï¼š02-xxxxxxxx, 03-xxxxxxx, 04-xxxxxxxx, 05-xxxxxxx, 06-xxxxxxx, 07-xxxxxxx, 08-xxxxxxxx
    const landlineRegex = /^0[2-8]\d{7,8}$/;  // ç°¡åŒ–ç‚ºç´”æ•¸å­—é©—è­‰
    
    if (!phoneRegex.test(cleanPhone) && !landlineRegex.test(cleanPhone)) {
      errors.phone = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„å°ç£é›»è©±è™Ÿç¢¼æ ¼å¼';
      isValid = false;
    }
  }
  
  // é©—è­‰éƒµç®± (å¦‚æœå¡«å¯«äº†)
  if (form.email && form.email.trim()) {
    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    if (!emailRegex.test(form.email.trim())) {
      errors.email = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµç®±åœ°å€æ ¼å¼';
      isValid = false;
    }
  }
  
  // é©—è­‰Line ID (å¦‚æœå¡«å¯«äº†)
  if (form.lineId && form.lineId.trim()) {
    if (form.lineId.trim().length < 3) {
      errors.lineId = 'Line IDè‡³å°‘éœ€è¦3å€‹å­—ç¬¦';
      isValid = false;
    } else if (form.lineId.trim().length > 50) {
      errors.lineId = 'Line IDä¸èƒ½è¶…é50å€‹å­—ç¬¦';
      isValid = false;
    }
  }
  
  // é©—è­‰æœå‹™é¡å‹
  if (!form.service) {
    errors.service = 'è«‹é¸æ“‡æ‚¨éœ€è¦çš„æœå‹™é¡å‹';
    isValid = false;
  }
  
  // é©—è­‰è«®è©¢æ™‚é–“
  if (form.startTime && form.endTime) {
    if (form.startTime >= form.endTime) {
      errors.consultationTime = 'çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“';
      isValid = false;
    }
  }
  
  // é©—è­‰å•é¡Œè©³æƒ…
  if (!form.details.trim()) {
    errors.details = 'è«‹æè¿°æ‚¨çš„å•é¡Œ';
    isValid = false;
  } else if (form.details.trim().length < 10) {
    errors.details = 'å•é¡Œæè¿°è‡³å°‘éœ€è¦10å€‹å­—ç¬¦ï¼Œè«‹æä¾›æ›´è©³ç´°çš„è³‡è¨Š';
    isValid = false;
  } else if (form.details.trim().length > 1000) {
    errors.details = 'å•é¡Œæè¿°ä¸èƒ½è¶…é1000å€‹å­—ç¬¦';
    isValid = false;
  }
  
  // é©—è­‰é¦–é¸è¯çµ¡æ–¹å¼
  if (!form.preferredContact.phone && !form.preferredContact.line && !form.preferredContact.email) {
    errors.preferredContact = 'è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®è¯çµ¡æ–¹å¼';
    isValid = false;
  }
  
  return isValid;
}

// ğŸ”§ æ–°å¢ï¼šå–®å€‹å­—æ®µé©—è­‰å‡½æ•¸
function validateField(fieldName) {
  // æ¸…é™¤è©²å­—æ®µçš„éŒ¯èª¤ä¿¡æ¯
  errors[fieldName] = '';
  
  switch (fieldName) {
    case 'name':
      if (!form.name.trim()) {
        errors.name = 'è«‹è¼¸å…¥æ‚¨çš„å§“å';
      } else if (form.name.trim().length < 2) {
        errors.name = 'å§“åè‡³å°‘éœ€è¦2å€‹å­—ç¬¦';
      } else if (form.name.trim().length > 50) {
        errors.name = 'å§“åä¸èƒ½è¶…é50å€‹å­—ç¬¦';
      }
      break;
      
    case 'phone':
      if (!form.phone.trim()) {
        errors.phone = 'è«‹è¼¸å…¥æ‚¨çš„è¯çµ¡é›»è©±';
      } else {
        // ğŸ”§ ä¿®å¾©ï¼šåœ¨é©—è­‰å‰å…ˆç§»é™¤æ‰€æœ‰éæ•¸å­—å­—ç¬¦ï¼Œä»¥å…¼å®¹æ ¼å¼åŒ–å¾Œçš„é›»è©±è™Ÿç¢¼
        const cleanPhone = form.phone.replace(/\D/g, '');
        
        // å°ç£æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼é©—è­‰ï¼š09xxxxxxxx
        const phoneRegex = /^0?9\d{8}$/;  // ç°¡åŒ–ç‚ºç´”æ•¸å­—é©—è­‰
        // ä¹Ÿæ”¯æ´å¸‚è©±æ ¼å¼ï¼š02-xxxxxxxx, 03-xxxxxxx, 04-xxxxxxxx, 05-xxxxxxx, 06-xxxxxxx, 07-xxxxxxx, 08-xxxxxxxx
        const landlineRegex = /^0[2-8]\d{7,8}$/;  // ç°¡åŒ–ç‚ºç´”æ•¸å­—é©—è­‰
        
        if (!phoneRegex.test(cleanPhone) && !landlineRegex.test(cleanPhone)) {
          errors.phone = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„å°ç£é›»è©±è™Ÿç¢¼æ ¼å¼';
        }
      }
      break;
      
    case 'email':
      if (form.email && form.email.trim()) {
        const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        if (!emailRegex.test(form.email.trim())) {
          errors.email = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„é›»å­éƒµç®±åœ°å€æ ¼å¼';
        }
      }
      break;
      
    case 'lineId':
      if (form.lineId && form.lineId.trim()) {
        if (form.lineId.trim().length < 3) {
          errors.lineId = 'Line IDè‡³å°‘éœ€è¦3å€‹å­—ç¬¦';
        } else if (form.lineId.trim().length > 50) {
          errors.lineId = 'Line IDä¸èƒ½è¶…é50å€‹å­—ç¬¦';
        }
      }
      break;
      
    case 'service':
      if (!form.service) {
        errors.service = 'è«‹é¸æ“‡æ‚¨éœ€è¦çš„æœå‹™é¡å‹';
      }
      break;
      
    case 'details':
      if (!form.details.trim()) {
        errors.details = 'è«‹æè¿°æ‚¨çš„å•é¡Œ';
      } else if (form.details.trim().length < 10) {
        errors.details = 'å•é¡Œæè¿°è‡³å°‘éœ€è¦10å€‹å­—ç¬¦ï¼Œè«‹æä¾›æ›´è©³ç´°çš„è³‡è¨Š';
      } else if (form.details.trim().length > 1000) {
        errors.details = 'å•é¡Œæè¿°ä¸èƒ½è¶…é1000å€‹å­—ç¬¦';
      }
      break;
      
    case 'consultationTime':
      if (form.startTime && form.endTime && form.startTime >= form.endTime) {
        errors.consultationTime = 'çµæŸæ™‚é–“å¿…é ˆæ™šæ–¼é–‹å§‹æ™‚é–“';
      }
      break;
      
    case 'preferredContact':
      if (!form.preferredContact.phone && !form.preferredContact.line && !form.preferredContact.email) {
        errors.preferredContact = 'è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®è¯çµ¡æ–¹å¼';
      }
      break;
  }
}

// ğŸ”§ æ–°å¢ï¼šé›»è©±è™Ÿç¢¼æ ¼å¼åŒ–
function formatPhoneNumber() {
  // ç§»é™¤æ‰€æœ‰éæ•¸å­—å­—ç¬¦
  let phone = form.phone.replace(/\D/g, '');
  
  // å°ç£æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼åŒ–
  if (phone.startsWith('09') && phone.length <= 10) {
    // æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ï¼š0912-345-678
    if (phone.length > 4 && phone.length <= 7) {
      form.phone = phone.slice(0, 4) + '-' + phone.slice(4);
    } else if (phone.length > 7) {
      form.phone = phone.slice(0, 4) + '-' + phone.slice(4, 7) + '-' + phone.slice(7, 10);
    } else {
      form.phone = phone;
    }
  } else if (phone.length <= 15) {
    // ä¿ç•™åŸå§‹è¼¸å…¥ï¼Œæ”¯æ´å…¶ä»–æ ¼å¼
    form.phone = phone;
  }
}

// ğŸ”§ æ–°å¢ï¼šæ›´æ–°å­—ç¬¦è¨ˆæ•¸
function updateDetailsCount() {
  // é€™å€‹å‡½æ•¸æœƒè‡ªå‹•è§¸ç™¼éŸ¿æ‡‰å¼æ›´æ–°ï¼Œé¡¯ç¤ºå­—ç¬¦è¨ˆæ•¸
}

// æäº¤è¡¨å–®
async function submitForm() {
  // ğŸš¨ ç¬¬ä¸€æ­¥ï¼šå¼·åˆ¶æª¢æŸ¥ç”¨æˆ¶èªè­‰ç‹€æ…‹
  console.log('MobileConsultation: submitForm - æª¢æŸ¥ç”¨æˆ¶èªè­‰');
  if (!checkAuthenticationAndRedirect()) {
    console.warn('MobileConsultation: submitForm - èªè­‰å¤±æ•—ï¼Œçµ‚æ­¢æäº¤');
    return; // å¦‚æœèªè­‰å¤±æ•—ï¼Œç›´æ¥è¿”å›
  }

  // ğŸ”’ ç¬¬äºŒæ­¥ï¼šç¢ºä¿ç²å–åˆ°æœ‰æ•ˆçš„ç”¨æˆ¶Tokenå’ŒID  
  const userToken = localStorage.getItem('auth_token');
  const userId = localStorage.getItem('auth_user_id');
  
  if (!userToken || !userId) {
    console.error('MobileConsultation: submitForm - ç„¡æ³•ç²å–ç”¨æˆ¶èªè­‰ä¿¡æ¯');
    alert('ç™»éŒ„ç‹€æ…‹å·²éæœŸï¼Œè«‹é‡æ–°ç™»éŒ„');
    router.push(`/mobile/login?redirect=${encodeURIComponent(route.fullPath)}`);
    return;
  }

  if (!validateForm()) {
    // æ»¾å‹•åˆ°ç¬¬ä¸€å€‹éŒ¯èª¤
    const firstError = document.querySelector('.text-red-600');
    if (firstError) {
      firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
    return;
  }
  
  isSubmitting.value = true;
  
  try {
    // å°‡è¤‡é¸è¯ç¹«æ–¹å¼è½‰æ›ç‚ºé™£åˆ—æ ¼å¼
    const preferredContactMethods = [];
    if (form.preferredContact.phone) preferredContactMethods.push('phone');
    if (form.preferredContact.line) preferredContactMethods.push('line');
    if (form.preferredContact.email) preferredContactMethods.push('email');
    
    // ğŸ”§ ä¿®å¤ï¼šéªŒè¯è”ç³»æ–¹å¼
    if (preferredContactMethods.length === 0) {
      throw new Error('è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®åå¥½è¯çµ¡æ–¹å¼');
    }
    
    // æº–å‚™APIæäº¤æ•¸æ“š
    const consultationData = {
      name: form.name,
      region: form.region,
      phone: form.phone,
      email: form.email,
      lineId: form.lineId,
      service: form.service,
      details: form.details,
      preferredContact: preferredContactMethods,
      timeOfDay: form.timeOfDay,
      startTime: form.startTime,
      endTime: form.endTime
    };
    
    console.log('ğŸ¯ ç§»å‹•ç«¯æº–å‚™æäº¤å°ˆå®¶è«®è©¢ç”³è«‹ï¼Œæ•¸æ“š:', consultationData);
    
    // ğŸ”§ ä¿®å¤ï¼šç›´æ¥ä½¿ç”¨expertConsultationServiceæäº¤ï¼Œä¸å†ä½¿ç”¨é™çº§æ–¹æ¡ˆ
    try {
      const apiResponse = await expertConsultationService.submitConsultation(consultationData, userToken);
      
      if (apiResponse && apiResponse.success) {
        console.log('âœ… ç§»å‹•ç«¯å°ˆå®¶è«®è©¢ç”³è«‹APIæäº¤æˆåŠŸ:', apiResponse);
        
        // ğŸ”§ ä¿®å¤ï¼šçœŸæ­£çš„APIæˆåŠŸåå†æ˜¾ç¤ºæˆåŠŸçŠ¶æ€
        // é‡ç½®è¡¨å–®
        Object.keys(form).forEach(key => {
          if (key === 'preferredContact') {
            form[key] = {
              phone: false,
              line: false,
              email: false
            };
          } else if (key === 'timeOfDay') {
            form[key] = 'morning';
          } else {
            form[key] = '';
          }
        });
        
        // é å¡«ç”¨æˆ¶ä¿¡æ¯ï¼ˆä¿æŒä¾¿åˆ©æ€§ï¼‰
        try {
          const user = authService.getCurrentUser();
          if (user) {
            form.name = user.name || '';
            form.email = user.email || '';
            form.phone = user.phoneNumber || user.phone || '';
          }
        } catch (error) {
          console.error('é‡æ–°é å¡«ç”¨æˆ¶ä¿¡æ¯å¤±æ•—:', error);
        }
        
        isSubmitSuccess.value = true;
        alert('âœ… å°ˆå®¶è«®è©¢ç”³è«‹æäº¤æˆåŠŸï¼æˆ‘å€‘æœƒç›¡å¿«èˆ‡æ‚¨è¯ç¹«ã€‚');
        
      } else {
        throw new Error(apiResponse?.message || 'APIéŸ¿æ‡‰ç•°å¸¸');
      }
      
    } catch (apiError) {
      console.error('âŒ ç§»å‹•ç«¯å°ˆå®¶è«®è©¢APIèª¿ç”¨å¤±æ•—:', apiError);
      
      // ğŸ”§ ä¿®å¤ï¼šAPIå¤±è´¥æ—¶ï¼Œä¸å†ä½¿ç”¨DataManageré™çº§ï¼Œç›´æ¥æ˜¾ç¤ºé”™è¯¯
      // ç§»é™¤æ‰€æœ‰DataManageré™çº§é€»è¾‘ï¼Œç¡®ä¿ç”¨æˆ·çœ‹åˆ°çœŸå®çš„APIå¤±è´¥çŠ¶æ€
      
      // ğŸ”§ ä¿®å¤ï¼šæä¾›æ›´å‡†ç¡®çš„é”™è¯¯æç¤º
      let errorMessage = 'æäº¤ç”³è«‹æ™‚å‡ºéŒ¯ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚';
      
      if (apiError.message?.includes('ç¼ºå°‘å¿…å¡«å­—æ®µ')) {
        errorMessage = `è¡¨å–®é©—è­‰å¤±æ•—ï¼š${apiError.message}`;
      } else if (apiError.message?.includes('è¯çµ¡æ–¹å¼')) {
        errorMessage = 'è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®åå¥½è¯çµ¡æ–¹å¼';
      } else if (apiError.message?.includes('è¼¸å…¥æ•¸æ“šé©—è­‰å¤±æ•—')) {
        errorMessage = 'æäº¤çš„æ•¸æ“šæ ¼å¼æœ‰èª¤ï¼Œè«‹æª¢æŸ¥è¡¨å–®å…§å®¹å¾Œé‡æ–°æäº¤';
      } else if (apiError.message?.includes('ç¶²è·¯') || apiError.message?.includes('Network')) {
        errorMessage = 'ç¶²è·¯é€£æ¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯å¾Œé‡è©¦';
      } else if (apiError.message?.includes('èªè­‰') || apiError.message?.includes('token')) {
        errorMessage = 'ç™»éŒ„ç‹€æ…‹å·²éæœŸï¼Œè«‹é‡æ–°ç™»éŒ„';
        setTimeout(() => {
          router.push(`/mobile/login?redirect=${encodeURIComponent(route.fullPath)}`);
        }, 2000);
      } else if (apiError.message) {
        errorMessage = apiError.message;
      }
      
      // ğŸ”§ ä¿®å¤ï¼šç›´æ¥æŠ›å‡ºé”™è¯¯ï¼Œè®©å¤–å±‚catchå¤„ç†
      throw new Error(errorMessage);
    }
    
  } catch (error) {
    console.error('âŒ ç§»å‹•ç«¯æäº¤å°ˆå®¶è«®è©¢ç”³è«‹æ™‚å‡ºéŒ¯:', error);
    
    // ğŸ”§ ä¿®å¤ï¼šæä¾›æ›´å‡†ç¡®çš„é”™è¯¯æç¤º
    let errorMessage = 'æäº¤ç”³è«‹æ™‚å‡ºéŒ¯ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚';
    
    if (error.message?.includes('ç¼ºå°‘å¿…å¡«å­—æ®µ')) {
      errorMessage = `è¡¨å–®é©—è­‰å¤±æ•—ï¼š${error.message}`;
    } else if (error.message?.includes('è¯çµ¡æ–¹å¼')) {
      errorMessage = 'è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®åå¥½è¯çµ¡æ–¹å¼';
    } else if (error.message?.includes('è¼¸å…¥æ•¸æ“šé©—è­‰å¤±æ•—')) {
      errorMessage = 'æäº¤çš„æ•¸æ“šæ ¼å¼æœ‰èª¤ï¼Œè«‹æª¢æŸ¥è¡¨å–®å…§å®¹';
    } else if (error.message?.includes('ç¶²è·¯') || error.message?.includes('Network')) {
      errorMessage = 'ç¶²è·¯é€£æ¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯å¾Œé‡è©¦';
    } else if (error.message?.includes('èªè­‰') || error.message?.includes('token')) {
      errorMessage = 'ç™»éŒ„ç‹€æ…‹å·²éæœŸï¼Œè«‹é‡æ–°ç™»éŒ„';
      setTimeout(() => {
        router.push(`/mobile/login?redirect=${encodeURIComponent(route.fullPath)}`);
      }, 2000);
    } else if (error.message) {
      errorMessage = error.message;
    }
    
    alert(errorMessage);
  } finally {
    isSubmitting.value = false;
  }
}
</script>

<style scoped>
.mobile-consultation-container {
  min-height: 100vh;
  background-color: #f5f5f5;
}

/* è‡ªå®šç¾©ä¸»é¡Œè‰²è®Šé‡ï¼Œèˆ‡å…¨å±€ä¿æŒä¸€è‡´ */
:root {
  --color-primary: #3b82f6;
  --color-primary-dark: #2563eb;
  --color-primary-50: #eff6ff;
}

.text-primary {
  color: var(--color-primary);
}

.bg-primary {
  background-color: var(--color-primary);
}

.bg-primary-50 {
  background-color: var(--color-primary-50);
}

.hover\:bg-primary-dark:hover {
  background-color: var(--color-primary-dark);
}

.border-primary {
  border-color: var(--color-primary);
}

/* é˜²æ­¢è¼¸å…¥æ™‚è¢«éµç›¤é®æ“‹ */
input:focus, 
select:focus, 
textarea:focus {
  scroll-margin-bottom: 80px;
}
</style> 