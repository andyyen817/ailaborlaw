# 📧 前端郵箱驗證API對接執行計劃任務清單 v1.0

## 📊 項目概覽

**項目名稱**: 勞法通AI - 郵箱驗證系統前端對接  
**預計總工時**: 8-10小時  
**優先級系統**: P0(緊急-上線必須) | P1(重要-1週內) | P2(一般-1個月內)  
**API文檔**: `email-verification-api-doc-v1.0.md`  
**後端基礎URL**: `https://wrrfvodsaofk.sealosgzg.site/api/v1`

---

## 🎯 第一階段：核心郵箱驗證服務開發

### 📧 任務1.1: 創建郵箱驗證服務模組 [P0]
**預計完成時間**: 20-25分鐘  
**依賴**: 無  
**負責人**: 開發者  

#### 🎯 任務目標
創建專門處理郵箱驗證的服務模組，與現有auth服務分離，避免代碼混亂

#### 📝 具體開發內容
1. **創建服務文件**: `src/services/emailVerificationService.js`
2. **實現7個用戶端API方法**:
   ```javascript
   - sendEmailVerification(email, type, language)     // 發送驗證碼
   - verifyEmail(email, code, type)                   // 驗證郵箱
   - resendVerification(email, type)                  // 重發驗證碼
   - checkVerificationStatus(email)                   // 檢查驗證狀態
   - sendPasswordReset(email)                         // 發送密碼重置
   - resetPassword(email, code, newPassword)          // 重置密碼
   - verifyInviteRegistration(email, code, inviteCode) // 邀請註冊驗證
   ```
3. **實現錯誤處理機制**:
   - 統一錯誤代碼映射
   - 網絡重試邏輯
   - 用戶友好的錯誤信息
4. **實現頻率限制邏輯**:
   - 60秒內限制重發
   - 倒數計時器支持
   - 本地狀態管理

#### ✅ 成功指標
- [ ] 所有7個API方法正確實現
- [ ] 錯誤處理覆蓋所有API文檔中的錯誤代碼
- [ ] 頻率限制邏輯正確工作
- [ ] 服務可被其他組件正確引用

#### 🧪 測試標準
- [ ] 使用測試賬號成功發送驗證郵件
- [ ] 正確驗證碼能夠驗證成功
- [ ] 錯誤驗證碼返回相應錯誤
- [ ] 重發限制正確生效
- [ ] 網絡錯誤時重試機制工作

---

### 📱 任務1.2: 修改註冊頁面流程 [P0]
**預計完成時間**: 30-40分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
將原本註冊成功直接跳轉登錄的流程，改為跳轉郵箱驗證頁面

#### 📝 具體開發內容
1. **修改桌面版註冊頁面**: `src/views/auth/RegisterView.vue`
   - 引入emailVerificationService
   - 修改handleRegister方法邏輯
   - 註冊成功後跳轉到emailVerification頁面
   - 傳遞郵箱地址和驗證類型參數

2. **修改移動版註冊頁面**: `src/views/auth/MobileRegisterView.vue`
   - 同樣修改註冊成功後的跳轉邏輯
   - 跳轉到mobile-email-verification頁面

3. **更新註冊提示文字**:
   - 將"我們將向此郵箱發送驗證鏈接"更新為"我們將向此郵箱發送驗證碼"
   - 添加郵箱驗證必要性說明

#### ✅ 成功指標
- [ ] 註冊成功後跳轉到郵箱驗證頁面
- [ ] 郵箱地址正確傳遞到驗證頁面
- [ ] 桌面版和移動版都正確修改
- [ ] 提示文字更新正確

#### 🧪 測試標準
- [ ] 使用新郵箱註冊，成功跳轉到驗證頁面
- [ ] 驗證頁面顯示正確的郵箱地址
- [ ] 移動端流程與桌面端一致
- [ ] 註冊錯誤時仍留在註冊頁面

---

### 📧 任務1.3: 創建郵箱驗證頁面 [P0]
**預計完成時間**: 40-50分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
創建專門的郵箱驗證頁面，支持註冊驗證、密碼重置、邀請確認三種模式

#### 📝 具體開發內容
1. **創建桌面版驗證頁面**: `src/views/auth/EmailVerificationView.vue`
   - 支持多種驗證模式(registration/password_reset/invite_confirmation)
   - 6位數字驗證碼輸入框(自動聚焦)
   - 60秒倒數計時重發按鈕
   - 驗證狀態顯示和錯誤處理
   - 返回上一頁功能

2. **創建移動版驗證頁面**: `src/views/auth/MobileEmailVerificationView.vue`
   - 相同功能但適配移動端UI
   - 優化觸屏操作體驗

3. **頁面功能實現**:
   ```javascript
   - 自動發送驗證碼(頁面載入時)
   - 驗證碼輸入驗證
   - 重發驗證碼功能
   - 倒數計時器
   - 驗證成功後跳轉邏輯
   - 錯誤狀態處理
   ```

4. **UI設計要求**:
   - 顯示發送到的郵箱地址
   - 清晰的步驟指示
   - 友好的錯誤和成功提示
   - 適當的加載狀態

#### ✅ 成功指標
- [ ] 頁面正確接收郵箱和驗證類型參數
- [ ] 自動發送驗證郵件並顯示狀態
- [ ] 驗證碼輸入框工作正常
- [ ] 倒數計時器準確控制重發按鈕
- [ ] 驗證成功後正確跳轉
- [ ] 所有錯誤情況有適當提示

#### 🧪 測試標準
- [ ] 從註冊頁面跳轉後自動發送驗證郵件
- [ ] 輸入正確驗證碼能夠驗證成功
- [ ] 輸入錯誤驗證碼顯示錯誤信息
- [ ] 60秒內重發按鈕被禁用
- [ ] 60秒後重發按鈕可用且功能正常
- [ ] 移動端頁面適配良好

---

## 🎯 第二階段：密碼重置功能開發

### 🔑 任務2.1: 創建忘記密碼頁面 [P0]
**預計完成時間**: 25-30分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
實現忘記密碼功能，讓用戶可以通過郵箱重置密碼

#### 📝 具體開發內容
1. **創建桌面版忘記密碼頁面**: `src/views/auth/ForgotPasswordView.vue`
   - 郵箱地址輸入表單
   - 表單驗證(郵箱格式)
   - 調用密碼重置API
   - 成功後跳轉到郵箱驗證頁面

2. **創建移動版忘記密碼頁面**: `src/views/auth/MobileForgotPasswordView.vue`
   - 相同功能但適配移動端

3. **更新登錄頁面鏈接**:
   - 修改`src/views/auth/LoginView.vue`中的"忘記密碼?"鏈接
   - 修改`src/views/auth/MobileLoginView.vue`中的鏈接
   - 指向新創建的忘記密碼頁面

4. **頁面功能實現**:
   ```javascript
   - 郵箱地址輸入驗證
   - 調用sendPasswordReset API
   - 錯誤處理和成功提示
   - 跳轉到郵箱驗證頁面(password_reset模式)
   ```

#### ✅ 成功指標
- [ ] 忘記密碼頁面UI完成
- [ ] 郵箱格式驗證正確
- [ ] 成功調用密碼重置API
- [ ] 登錄頁面鏈接更新正確
- [ ] 成功跳轉到驗證頁面

#### 🧪 測試標準
- [ ] 從登錄頁面點擊"忘記密碼?"正確跳轉
- [ ] 輸入有效郵箱能夠發送重置郵件
- [ ] 輸入無效郵箱顯示錯誤信息
- [ ] 未註冊郵箱顯示相應提示
- [ ] 發送成功後跳轉到驗證頁面

---

### 🔐 任務2.2: 創建密碼重置頁面 [P0]
**預計完成時間**: 35-50分鐘  
**依賴**: 任務1.3, 任務2.1  
**負責人**: 開發者

#### 🎯 任務目標
創建密碼重置頁面，用戶可以輸入驗證碼和新密碼完成重置

#### 📝 具體開發內容
1. **創建桌面版密碼重置頁面**: `src/views/auth/ResetPasswordView.vue`
   - 驗證碼輸入區域
   - 新密碼輸入表單
   - 密碼強度檢查(複用現有組件邏輯)
   - 確認密碼輸入
   - 調用密碼重置API

2. **創建移動版密碼重置頁面**: `src/views/auth/MobileResetPasswordView.vue`
   - 相同功能適配移動端

3. **修改郵箱驗證頁面**:
   - 在password_reset模式下，驗證成功後跳轉到密碼重置頁面
   - 傳遞必要的參數(郵箱地址、驗證碼)

4. **頁面功能實現**:
   ```javascript
   - 接收郵箱和驗證碼參數
   - 新密碼強度驗證
   - 密碼確認匹配檢查
   - 調用resetPassword API
   - 重置成功後跳轉登錄頁面
   ```

#### ✅ 成功指標
- [ ] 密碼重置頁面正確接收參數
- [ ] 密碼強度檢查正常工作
- [ ] 密碼確認驗證正確
- [ ] 成功調用重置密碼API
- [ ] 重置成功後跳轉登錄頁面

#### 🧪 測試標準
- [ ] 從郵箱驗證頁面正確跳轉
- [ ] 密碼強度指示器工作正常
- [ ] 弱密碼無法提交
- [ ] 密碼不匹配時顯示錯誤
- [ ] 重置成功後可以用新密碼登錄

---

## 🎯 第三階段：邀請系統集成

### 🎁 任務3.1: 修改邀請註冊流程 [P1]
**預計完成時間**: 30-40分鐘  
**依賴**: 任務1.3  
**負責人**: 開發者

#### 🎯 任務目標
將邀請註冊與郵箱驗證結合，確保邀請獎勵正確發放

#### 📝 具體開發內容
1. **修改郵箱驗證頁面邏輯**:
   - 檢測是否為邀請註冊模式
   - 如果有邀請碼，使用verifyInviteRegistration API
   - 驗證成功後顯示邀請獎勵信息

2. **修改註冊頁面邀請碼處理**:
   - 確保邀請碼正確傳遞到驗證頁面
   - 在驗證頁面顯示邀請人信息(如果可獲得)

3. **創建邀請獎勵顯示組件**:
   - 顯示獲得的額外查詢次數
   - 顯示邀請人信息
   - 友好的獎勵確認界面

#### ✅ 成功指標
- [ ] 邀請註冊流程使用正確的API
- [ ] 邀請獎勵正確發放並顯示
- [ ] 邀請碼驗證集成到郵箱驗證流程
- [ ] 用戶體驗友好

#### 🧪 測試標準
- [ ] 使用邀請碼註冊能正確驗證
- [ ] 邀請人和被邀請人都獲得獎勵
- [ ] 無效邀請碼顯示錯誤信息
- [ ] 邀請記錄正確保存

---

### 📧 任務3.2: 邀請管理頁面集成 [P1]
**預計完成時間**: 30-50分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
在現有邀請管理頁面中集成郵箱通知功能

#### 📝 具體開發內容
1. **修改邀請管理頁面**: `src/views/admin/InviteManagementView.vue`
   - 添加"發送邀請郵件"按鈕
   - 實現邀請郵件發送功能
   - 更新邀請狀態顯示

2. **實現批量邀請功能**:
   - 支持選擇多個邀請記錄
   - 批量發送邀請確認郵件
   - 顯示發送進度和結果

3. **邀請狀態跟蹤**:
   - 增加郵件發送狀態字段
   - 統計邀請郵件發送成功率
   - 提供重發功能

#### ✅ 成功指標
- [ ] 邀請管理頁面集成郵件功能
- [ ] 批量邀請功能正常工作
- [ ] 邀請狀態正確跟蹤和顯示
- [ ] 郵件發送統計準確

#### 🧪 測試標準
- [ ] 單個邀請郵件發送成功
- [ ] 批量邀請功能正常
- [ ] 邀請狀態更新正確
- [ ] 重發功能可用

---

## 🎯 第四階段：管理後台郵件功能

### 📊 任務4.1: 創建郵件統計頁面 [P1]
**預計完成時間**: 45-60分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
為管理員提供郵件發送統計和監控功能

#### 📝 具體開發內容
1. **創建郵件統計頁面**: `src/views/admin/EmailStatisticsView.vue`
   - 統計卡片顯示(總發送數、成功率、驗證率等)
   - 按類型統計圖表
   - 按日期統計趨勢圖
   - 失敗原因分析

2. **集成圖表組件**:
   - 使用Chart.js或ECharts
   - 柱狀圖、線圖、餅圖等
   - 響應式圖表設計

3. **實現篩選功能**:
   - 日期範圍選擇器
   - 郵件類型篩選
   - 實時數據刷新

4. **調用管理員API**:
   ```javascript
   - getEmailStatistics(startDate, endDate, type)
   - 處理統計數據渲染
   - 錯誤處理和加載狀態
   ```

#### ✅ 成功指標
- [ ] 統計頁面正確顯示各項數據
- [ ] 圖表渲染正確且美觀
- [ ] 篩選功能正常工作
- [ ] 數據刷新機制完善

#### 🧪 測試標準
- [ ] 統計數據與實際發送記錄一致
- [ ] 圖表交互功能正常
- [ ] 日期篩選準確過濾數據
- [ ] 頁面在無數據時友好顯示

---

### 📋 任務4.2: 創建郵件日志管理頁面 [P1]
**預計完成時間**: 45-60分鐘  
**依賴**: 任務1.1  
**負責人**: 開發者

#### 🎯 任務目標
為管理員提供詳細的郵件發送日志查看和管理功能

#### 📝 具體開發內容
1. **創建郵件日志頁面**: `src/views/admin/EmailLogsView.vue`
   - 分頁表格顯示郵件記錄
   - 多條件搜索功能
   - 郵件詳情查看
   - 重發失敗郵件功能

2. **實現搜索和篩選**:
   - 按郵箱地址搜索
   - 按用戶ID搜索
   - 按郵件類型篩選
   - 按狀態篩選
   - 按日期範圍篩選

3. **分頁和排序功能**:
   - 支持每頁20/50/100條記錄
   - 按發送時間排序
   - 按狀態排序

4. **管理功能**:
   ```javascript
   - getEmailLogs(page, limit, filters)
   - resendFailedEmail(logId)
   - exportEmailLogs(filters)
   - cleanupExpiredLogs(daysOld)
   ```

#### ✅ 成功指標
- [ ] 日志表格正確顯示所有字段
- [ ] 搜索和篩選功能完善
- [ ] 分頁功能正常工作
- [ ] 重發功能成功實現

#### 🧪 測試標準
- [ ] 日志記錄顯示完整準確
- [ ] 搜索功能能準確找到記錄
- [ ] 重發失敗郵件功能正常
- [ ] 導出功能可用

---

## 🎯 第五階段：UI/UX優化和測試

### ✨ 任務5.1: 創建通用組件 [P2]
**預計完成時間**: 30-40分鐘  
**依賴**: 任務1.3  
**負責人**: 開發者

#### 🎯 任務目標
提取通用組件，提高代碼複用性和維護性

#### 📝 具體開發內容
1. **創建驗證碼輸入組件**: `src/components/auth/VerificationCodeInput.vue`
   - 6位數字輸入框
   - 自動聚焦和跳轉
   - 自動提交功能
   - 錯誤狀態顯示

2. **創建倒數計時器組件**: `src/components/auth/CountdownTimer.vue`
   - 可配置倒數時間
   - 自動禁用/啟用按鈕
   - 顯示剩餘時間

3. **創建郵件狀態組件**: `src/components/auth/EmailStatus.vue`
   - 統一的狀態指示器
   - 成功/失敗/加載狀態
   - 友好的圖標和文字

4. **重構現有頁面使用組件**:
   - 更新郵箱驗證頁面使用新組件
   - 確保功能一致性

#### ✅ 成功指標
- [ ] 通用組件功能完善
- [ ] 現有頁面成功重構
- [ ] 組件復用性良好
- [ ] UI一致性提升

#### 🧪 測試標準
- [ ] 組件在不同頁面中表現一致
- [ ] 組件API設計合理
- [ ] 組件樣式統一美觀
- [ ] 組件性能良好

---

### 🔄 任務5.2: 路由配置和導航更新 [P2]
**預計完成時間**: 15-20分鐘  
**依賴**: 所有頁面創建任務  
**負責人**: 開發者

#### 🎯 任務目標
更新路由配置，確保所有新頁面可以正確訪問

#### 📝 具體開發內容
1. **更新路由配置**: `src/router/index.js`
   ```javascript
   // 添加新路由
   /email-verification
   /mobile-email-verification  
   /forgot-password
   /mobile-forgot-password
   /reset-password
   /mobile-reset-password
   /admin/email-statistics
   /admin/email-logs
   ```

2. **更新導航菜單**:
   - 管理後台側邊欄添加郵件管理菜單
   - 登錄頁面更新忘記密碼鏈接

3. **設置路由守衛**:
   - 郵箱驗證頁面需要適當的參數
   - 管理後台頁面需要管理員權限

#### ✅ 成功指標
- [ ] 所有新路由配置正確
- [ ] 導航菜單更新完成
- [ ] 路由守衛設置合理
- [ ] 頁面跳轉邏輯正確

#### 🧪 測試標準
- [ ] 直接訪問所有新頁面URL正常
- [ ] 從導航菜單跳轉正常
- [ ] 權限控制正確生效
- [ ] 無權限時跳轉合理

---

### 🧪 任務5.3: 綜合測試和調試 [P2]
**預計完成時間**: 30-60分鐘  
**依賴**: 所有前置任務  
**負責人**: 開發者

#### 🎯 任務目標
全面測試郵箱驗證系統，確保功能穩定可靠

#### 📝 具體測試內容
1. **功能測試清單**:
   - [ ] 註冊郵箱驗證完整流程
   - [ ] 密碼重置完整流程
   - [ ] 邀請註冊驗證流程
   - [ ] 管理後台統計查看
   - [ ] 管理後台日志管理

2. **錯誤場景測試**:
   - [ ] 無效驗證碼處理
   - [ ] 過期驗證碼處理
   - [ ] 網絡錯誤處理
   - [ ] 頻率限制測試
   - [ ] 無效郵箱測試

3. **用戶體驗測試**:
   - [ ] 移動端響應式顯示
   - [ ] 加載狀態指示
   - [ ] 錯誤提示友好性
   - [ ] 操作流程順暢性

4. **性能測試**:
   - [ ] 頁面加載速度
   - [ ] API響應時間
   - [ ] 組件渲染性能
   - [ ] 內存使用情況

#### ✅ 成功指標
- [ ] 所有功能測試通過
- [ ] 錯誤場景處理恰當
- [ ] 用戶體驗良好
- [ ] 性能表現良好

#### 🧪 測試標準
- [ ] 完整流程無阻塞
- [ ] 錯誤恢復機制完善
- [ ] 移動端體驗良好
- [ ] 響應時間在合理範圍

---

## 📊 項目進度跟蹤表

| 階段 | 任務 | 狀態 | 預計耗時 | 實際耗時 | 負責人 | 備註 |
|------|------|------|----------|----------|---------|------|
| 第一階段 | 任務1.1 - 創建郵箱驗證服務 | ⏳ 待開始 | 20-25分鐘 | - | 開發者 | P0優先 |
| 第一階段 | 任務1.2 - 修改註冊頁面流程 | ⏳ 待開始 | 30-40分鐘 | - | 開發者 | P0優先 |
| 第一階段 | 任務1.3 - 創建郵箱驗證頁面 | ⏳ 待開始 | 40-50分鐘 | - | 開發者 | P0優先 |
| 第二階段 | 任務2.1 - 創建忘記密碼頁面 | ⏳ 待開始 | 25-30分鐘 | - | 開發者 | P0優先 |
| 第二階段 | 任務2.2 - 創建密碼重置頁面 | ⏳ 待開始 | 35-50分鐘 | - | 開發者 | P0優先 |
| 第三階段 | 任務3.1 - 修改邀請註冊流程 | ⏳ 待開始 | 30-40分鐘 | - | 開發者 | P1重要 |
| 第三階段 | 任務3.2 - 邀請管理頁面集成 | ⏳ 待開始 | 30-50分鐘 | - | 開發者 | P1重要 |
| 第四階段 | 任務4.1 - 創建郵件統計頁面 | ⏳ 待開始 | 45-60分鐘 | - | 開發者 | P1重要 |
| 第四階段 | 任務4.2 - 創建郵件日志頁面 | ⏳ 待開始 | 45-60分鐘 | - | 開發者 | P1重要 |
| 第五階段 | 任務5.1 - 創建通用組件 | ⏳ 待開始 | 30-40分鐘 | - | 開發者 | P2一般 |
| 第五階段 | 任務5.2 - 路由配置更新 | ⏳ 待開始 | 15-20分鐘 | - | 開發者 | P2一般 |
| 第五階段 | 任務5.3 - 綜合測試調試 | ⏳ 待開始 | 30-60分鐘 | - | 開發者 | P2一般 |

**狀態圖例**: ⏳ 待開始 | 🔄 進行中 | ✅ 已完成 | ❌ 有問題 | ⏸️ 暫停

---

## 🔍 質量保證檢查清單

### 📋 代碼質量標準
- [ ] **API服務**: 錯誤處理完善，支持重試機制
- [ ] **Vue組件**: 符合Vue 3 Composition API最佳實踐
- [ ] **樣式設計**: 響應式設計，移動端適配良好
- [ ] **性能優化**: 懶加載，代碼分割合理
- [ ] **可維護性**: 代碼注釋完整，結構清晰

### 🧪 測試覆蓋要求
- [ ] **功能測試**: 所有主要功能路徑測試通過
- [ ] **異常測試**: 網絡錯誤、無效數據等場景處理正確
- [ ] **兼容性測試**: 主流瀏覽器和設備測試通過
- [ ] **性能測試**: 頁面加載和API響應時間合理
- [ ] **安全測試**: 輸入驗證和敏感信息處理安全

### 📱 用戶體驗標準
- [ ] **易用性**: 操作流程直觀，引導清晰
- [ ] **友好性**: 錯誤提示友好，成功提示明確
- [ ] **響應性**: 加載狀態明確，操作反饋及時
- [ ] **一致性**: UI風格與現有系統保持一致
- [ ] **可訪問性**: 支持鍵盤操作，對屏幕閱讀器友好

---

## 🚀 上線準備檢查清單

### ✅ 功能完整性檢查
- [ ] P0功能100%完成並測試通過
- [ ] P1功能完成並基本測試通過
- [ ] 所有API接口正確對接
- [ ] 錯誤處理機制完善
- [ ] 用戶體驗流程順暢

### 🔧 技術準備檢查
- [ ] 代碼審查完成
- [ ] 性能優化完成
- [ ] 安全檢查通過
- [ ] 瀏覽器兼容性確認
- [ ] 移動端適配確認

### 📚 文檔準備檢查
- [ ] 用戶使用指南更新
- [ ] 管理員操作手冊更新
- [ ] API對接文檔完善
- [ ] 常見問題解答準備
- [ ] 技術文檔歸檔

---

## 📞 支持和維護計劃

### 🔧 上線後監控項目
- **郵件發送成功率**: 目標 >95%
- **郵箱驗證完成率**: 目標 >80%
- **頁面加載時間**: 目標 <3秒
- **API響應時間**: 目標 <1秒
- **用戶投訴率**: 目標 <1%

### 🛠️ 維護計劃
- **每日監控**: 查看郵件發送統計和錯誤日志
- **每週分析**: 分析用戶使用行為和問題趨勢
- **每月優化**: 根據數據和反饋進行功能優化
- **季度升級**: 評估新功能需求和技術升級

---

**📝 更新記錄**:
- v1.0 (2025-01-28): 初始版本創建，包含完整的執行計劃和質量標準

**👨‍💻 使用說明**: 
1. 請嚴格按照任務優先級P0→P1→P2順序執行
2. 每完成一個任務請更新進度表中的狀態
3. 遇到問題請及時記錄並尋求技術支持
4. 所有P0任務完成後進行第一次整體測試
5. 建議每天結束時更新進度並規劃次日任務

**🎯 成功標準**: 系統上線時所有P0功能穩定運行，用戶可以順利完成註冊郵箱驗證和密碼重置流程。 